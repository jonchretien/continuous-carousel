/*!
 * Infinite Carousel v0.0.0
 * Timed infinite carousel that uses vanilla JavaScript & CSS animations.
 *
 * @license Released under the MIT license.
 * @copyright 2015 Jon Chretien
 */
!function(){"use strict";function t(t,e,s,r){if(!t||"string"!=typeof t)throw new Error("Auto Scroller requires a selector.");if(!e||"string"!=typeof e)throw new Error("Auto Scroller requires a direction.");if(!s||"number"!=typeof s)throw new Error("numVisible argument must be number.");this.container=document.querySelector(t),this.direction=e,this.items=this.container.children,this.firstItem=this.items[0],this.numItems=this.items.length,this.numVisible=s,this.options=n.extend(this.defaults,r),this.pos=0,this.isBypassingTimer=!1,this.isReadyToReset=!1,this.scrollingDistance=null,this.timerDuration=this.options.timerDuration,this.transformEvent=n.getVendorPrefix(i.TRANSFORM),this.transitionDuration=this.options.transitionDuration,this.transitionEndEvent=n.getVendorPrefix(i.TRANSITION_END),this.TRANSITION_DURATION_RESET="0.001s",this._init()}var i={TRANSFORM:{transform:"transform",WebkitTransform:"webkitTransform"},TRANSITION_END:{transition:"transitionend",MSTransitionEnd:"msTransitionEnd",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd"}},n={extend:function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);return t},getVendorPrefix:function(t){var i=document.createElement("div");for(var n in t)if(t.hasOwnProperty(n)&&void 0!==i.style[n])return t[n]},cloneNodes:function(t,i,n){for(var e=document.createDocumentFragment(),s=0;i>s;++s){var r=t[s].cloneNode(!0);e.appendChild(r)}n.appendChild(e)}};t.prototype.defaults={timerDuration:2e3,transitionDuration:"1s"},t.prototype._init=function(){"vertical"===this.direction&&this._setContainerAttributes("data-top","margin-bottom"),"horizontal"===this.direction&&this._setContainerAttributes("data-left","margin-right"),n.cloneNodes(this.items,this.numVisible,this.container),this._attachEvents(),this._setTimer()},t.prototype._setContainerAttributes=function(t,i){this.container.setAttribute(t,this.pos);var n="vertical"===this.direction?this.firstItem.offsetHeight:this.firstItem.offsetWidth;this.scrollingDistance=n+parseInt(getComputedStyle(this.firstItem)[i].slice(0,-2),10),this.endPosition=-(this.scrollingDistance*this.numItems),"horizontal"===this.direction&&this.container.setAttribute("style","width: "+this.scrollingDistance*(this.numItems+this.numVisible)+"px")},t.prototype._attachEvents=function(){this.container.addEventListener(this.transitionEndEvent,this._onTransitionEnd.bind(this),!1)},t.prototype._onTransitionEnd=function(t){if(t.target===t.currentTarget){if(this.isBypassingTimer)return this.isBypassingTimer=!1,void this._animateContainer();this._monitorScrollPosition(),this.container.addEventListener(this.transitionEndEvent,this._removeEventHandlers.bind(this))}},t.prototype._removeEventHandlers=function(){this.container.removeEventListener(this.transitionEndEvent,this._removeEventHandlers.bind(this))},t.prototype._setTimer=function(){setTimeout(function(){this._animateContainer()}.bind(this),this.timerDuration)},t.prototype._animateContainer=function(){this.isReadyToReset||(this.pos=this.pos-this.scrollingDistance,this.container.style.transitionDuration=this.transitionDuration),this.isReadyToReset&&(this.isReadyToReset=!1,this.isBypassingTimer=!0,this.pos=0,this.container.style.transitionDuration=this.TRANSITION_DURATION_RESET);var t="vertical"===this.direction?"data-top":"data-left";this.container.setAttribute(t,this.pos);var i="vertical"===this.direction?"translate3d(0, "+this.pos+"px, 0)":"translate3d("+this.pos+"px, 0, 0)";this.container.style[this.transformEvent]=i},t.prototype._monitorScrollPosition=function(){var t=this.container.getAttribute("vertical"===this.direction?"data-top":"data-left");parseInt(t,10)===this.endPosition&&(this.isReadyToReset=!0),this._setTimer()},"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t:window.InfiniteCarousel=t}();