/*!
 * Continuous Carousel ðŸŽ  v1.0.0
 * Continuous carousel that uses vanilla JavaScript & CSS animations.
 * @author Jon Chretien
 * @license Released under the MIT license.
 */
const e="horizontal",n="vertical",t="data-paused",o={direction:e,numVisible:1,interval:2e3,transitionDuration:1e3,resetDuration:1,pauseOnHover:!1,pauseOnFocus:!1,autoplay:!0,observeVisibility:!0,observeResize:!0,ariaLive:"polite",announceSlides:!0,onSlideChange:null,onPause:null,onPlay:null,reverse:!1,keyboardNav:!0,onDestroy:null};function r(t){const o=t.toLowerCase().trim();if(o!==e&&o!==n)throw new Error(`Direction must be either "${e}" or "${n}"`);return o}function i(e){const n=Number(e);if(isNaN(n)||n<1||!Number.isInteger(n))throw new Error("numVisible must be a positive integer");return n}function s(e,n,t){e&&(e.textContent=`Item ${n} of ${t}`)}function a(e){const n=document.createDocumentFragment();return e.forEach(e=>{const t=e.cloneNode(!0);n.appendChild(t)}),n}function u(e,n){Object.entries(n).forEach(([n,t])=>{e.style.setProperty(n,t)})}const c={getTransform:e=>`translate3d(${e}px, 0, 0)`,getMeasurement:e=>e.offsetWidth,getSizeProperty:()=>"width",getCSSVariableName:()=>"--carousel-item-width"},l={getTransform:e=>`translate3d(0, ${e}px, 0)`,getMeasurement:e=>e.offsetHeight,getSizeProperty:()=>"height",getCSSVariableName:()=>"--carousel-item-height"};function d(e,n={}){const{debounceDelay:t=150}=n;let o=null,r=null;function i(){e.recalculateDimensions&&e.recalculateDimensions()}function s(){r=function(e,n){let t;return function(...o){clearTimeout(t),t=setTimeout(()=>e.apply(this,o),n)}}(i,t),window.addEventListener("resize",r)}return{observe:function(){if(!("ResizeObserver"in window))return console.warn("ResizeObserver not supported. Using window resize fallback."),void s();o||(o=new ResizeObserver(()=>{i()})),o.observe(e.container)},disconnect:function(){o&&(o.disconnect(),o=null),r&&(window.removeEventListener("resize",r),r=null)}}}function f(f,v={}){const m=function(e){let n=e;if("string"==typeof e&&(n=document.getElementById(e),!n))throw new Error(`Carousel container with id "${e}" not found`);if(!(n instanceof HTMLElement))throw new Error("Carousel container must be an HTMLElement or valid element ID");return n}(f),b=m.getAttribute("data-direction"),g=m.getAttribute("data-num-visible"),p=m.getAttribute("data-reverse"),h={...o,...b&&{direction:r(b)},...g&&{numVisible:i(g)},...null!==p&&{reverse:(w=p,"string"==typeof w?"true"===w.toLowerCase():Boolean(w))},...v};var w;const y=r(h.direction),S=i(h.numVisible),D=m.querySelector(".c-carousel-group"),E=Array.from(m.querySelectorAll(".c-carousel-item")),C=E.length;!function(e,n){e>=n&&console.warn(`numVisible (${e}) must be less than item count (${n}). Carousel may not behave correctly.`)}(S,C);let A=1,L=0,z=null,$=!1;const O=function(t){const o={[e]:c,[n]:l}[t];if(!o)throw new Error(`Invalid direction: ${t}. Must be "${e}" or "${n}"`);return o}(y);let I=null,P=null,N=null,T=null;function V(){const e=O.getMeasurement(m),n=e/S;return u(m,{"--carousel-item-width":"horizontal"===y?`${n}px`:"auto","--carousel-item-height":"vertical"===y?`${n}px`:"auto","--carousel-item-count":C+S,"--carousel-transition-duration":`${h.transitionDuration}ms`}),{itemSize:n,containerSize:e}}function k(e,n){D.style.transform=O.getTransform(e),void 0!==n&&u(m,{"--carousel-transition-duration":`${n}ms`})}function R(e){const{itemSize:n}=V();if(void 0!==e?!e:h.reverse){L===0?(L=-n*C,A=C,k(L,h.resetDuration),setTimeout(()=>{L+=n*S,A--,A<1&&(A=C),k(L,h.transitionDuration),z&&s(z,A,C),h.onSlideChange&&h.onSlideChange(A)},h.resetDuration+50)):(L+=n*S,A--,A<1&&(A=C),k(L,h.transitionDuration),z&&s(z,A,C),h.onSlideChange&&h.onSlideChange(A))}else{L===-n*C?(L=0,A=1,k(L,h.resetDuration),setTimeout(()=>{L-=n*S,A++,k(L,h.transitionDuration),z&&s(z,A,C),h.onSlideChange&&h.onSlideChange(A)},h.resetDuration+50)):(L-=n*S,A++,A>C&&(A=1),k(L,h.transitionDuration),z&&s(z,A,C),h.onSlideChange&&h.onSlideChange(A))}}function x(){$&&($=!1,m.setAttribute(t,"false"),I&&(I.getIsPaused()?I.resume():I.getIsRunning()||I.start()),h.onPlay&&h.onPlay())}function F(){$||($=!0,m.setAttribute(t,"true"),I&&I.pause(),h.onPause&&h.onPause())}function H(){$?x():F()}return function(){if(h.reverse){const e=a(E.slice(-S));D.insertBefore(e,D.firstChild);const{itemSize:n}=V();L=-n*S,k(L,0)}else{const e=a(E.slice(0,S));D.appendChild(e),V()}h.announceSlides&&(z=function(e,n="polite"){const t=document.createElement("div");return t.setAttribute("aria-live",n),t.setAttribute("aria-atomic","true"),t.className="c-carousel-liveregion c-carousel-visuallyhidden",e.appendChild(t),t}(m,h.ariaLive),s(z,A,C)),I=function(e,n={}){const{interval:t=2e3}=n;let o=null,r=0,i=!1,s=!1;function a(n){i||(0===r&&(r=n),n-r>=t&&(e.advanceSlide&&e.advanceSlide(),r=n)),o=requestAnimationFrame(a)}return{start:function(){s||(s=!0,i=!1,r=0,o=requestAnimationFrame(a))},stop:function(){o&&(cancelAnimationFrame(o),o=null),s=!1,i=!1,r=0},pause:function(){i=!0},resume:function(){i&&(i=!1,r=0)},getIsRunning:function(){return s},getIsPaused:function(){return i}}}({advanceSlide:R,container:m},{interval:h.interval}),h.observeResize&&(N=d({recalculateDimensions:V,container:m}),N.observe()),h.observeVisibility&&(P=function(e,n={}){const{threshold:t=.5}=n;let o=null;function r(n){n.forEach(n=>{n.isIntersecting?e.play():e.pause()})}return{observe:function(){"IntersectionObserver"in window?(o||(o=new IntersectionObserver(r,{threshold:t})),o.observe(e.container)):console.warn("IntersectionObserver not supported. Carousel will run continuously.")},disconnect:function(){o&&(o.disconnect(),o=null)}}}({play:x,pause:F,container:m},{threshold:.5}),P.observe()),h.keyboardNav&&(T=function(e){function n(n){switch(n.key){case"ArrowRight":case"ArrowDown":n.preventDefault(),e.advanceSlide(!0);break;case"ArrowLeft":case"ArrowUp":n.preventDefault(),e.advanceSlide(!1);break;case" ":case"Enter":n.preventDefault(),e.togglePause()}}return{observe:function(){const t=e.container;t.setAttribute("tabindex","0"),t.setAttribute("role","region"),t.setAttribute("aria-roledescription","carousel"),t.addEventListener("keydown",n)},disconnect:function(){e.container.removeEventListener("keydown",n)}}}({advanceSlide:R,togglePause:H,container:m}),T.observe()),h.pauseOnHover&&(m.addEventListener("mouseenter",F),m.addEventListener("mouseleave",x)),h.pauseOnFocus&&(m.addEventListener("focusin",F),m.addEventListener("focusout",x)),h.autoplay&&I.start()}(),{play:x,pause:F,destroy:function(){I&&I.stop(),P&&P.disconnect(),N&&N.disconnect(),T&&T.disconnect(),h.pauseOnHover&&(m.removeEventListener("mouseenter",F),m.removeEventListener("mouseleave",x)),h.pauseOnFocus&&(m.removeEventListener("focusin",F),m.removeEventListener("focusout",x)),z&&z.remove(),h.onDestroy&&h.onDestroy()},updateConfig:function(e){Object.assign(h,e),void 0!==e.transitionDuration&&V()},container:m,config:h}}export{f as default};