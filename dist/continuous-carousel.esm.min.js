/*!
 * Continuous Carousel âˆž v0.3.0
 * Continuous carousel that uses vanilla JavaScript & CSS animations.
 * @author Jon Chretien
 * @license Released under the MIT license.
 */
const e="horizontal",n="vertical",t="data-paused",o={direction:e,numVisible:1,interval:2e3,transitionDuration:1e3,resetDuration:1,pauseOnHover:!1,pauseOnFocus:!1,autoplay:!0,observeVisibility:!0,observeResize:!0,ariaLive:"polite",announceSlides:!0,onSlideChange:null,onPause:null,onPlay:null,onDestroy:null};function i(t){const o=t.toLowerCase().trim();if(o!==e&&o!==n)throw new Error(`Direction must be either "${e}" or "${n}"`);return o}function r(e){const n=Number(e);if(isNaN(n)||n<1||!Number.isInteger(n))throw new Error("numVisible must be a positive integer");return n}function s(e,n,t){e&&(e.textContent=`Item ${n} of ${t}`)}function u(e,n){Object.entries(n).forEach(([n,t])=>{e.style.setProperty(n,t)})}const a={getTransform:e=>`translate3d(${e}px, 0, 0)`,getMeasurement:e=>e.offsetWidth,getSizeProperty:()=>"width",getCSSVariableName:()=>"--carousel-item-width"},c={getTransform:e=>`translate3d(0, ${e}px, 0)`,getMeasurement:e=>e.offsetHeight,getSizeProperty:()=>"height",getCSSVariableName:()=>"--carousel-item-height"};function l(e,n={}){const{debounceDelay:t=150}=n;let o=null,i=null;function r(){e.recalculateDimensions&&e.recalculateDimensions()}function s(){i=function(e,n){let t;return function(...o){clearTimeout(t),t=setTimeout(()=>e.apply(this,o),n)}}(r,t),window.addEventListener("resize",i)}return{observe:function(){if(!("ResizeObserver"in window))return console.warn("ResizeObserver not supported. Using window resize fallback."),void s();o||(o=new ResizeObserver(()=>{r()})),o.observe(e.container)},disconnect:function(){o&&(o.disconnect(),o=null),i&&(window.removeEventListener("resize",i),i=null)}}}function d(d,m={}){const f=function(e){let n=e;if("string"==typeof e&&(n=document.getElementById(e),!n))throw new Error(`Carousel container with id "${e}" not found`);if(!(n instanceof HTMLElement))throw new Error("Carousel container must be an HTMLElement or valid element ID");return n}(d),v=f.getAttribute("data-direction"),p=f.getAttribute("data-num-visible"),b={...o,...v&&{direction:i(v)},...p&&{numVisible:r(p)},...m},g=i(b.direction),h=r(b.numVisible),w=f.querySelector(".c-carousel-group"),y=Array.from(f.querySelectorAll(".c-carousel-item")),E=y.length;let S=1,D=0,C=null,z=!1;const L=function(t){const o={[e]:a,[n]:c}[t];if(!o)throw new Error(`Invalid direction: ${t}. Must be "${e}" or "${n}"`);return o}(g);let O=null,$=null,I=null;function A(){const e=L.getMeasurement(f),n=e/h;return u(f,{"--carousel-item-width":"horizontal"===g?`${n}px`:"auto","--carousel-item-height":"vertical"===g?`${n}px`:"auto","--carousel-item-count":E+h,"--carousel-transition-duration":`${b.transitionDuration}ms`}),{itemSize:n,containerSize:e}}function P(e,n){w.style.transform=L.getTransform(e),void 0!==n&&u(f,{"--carousel-transition-duration":`${n}ms`})}function N(){const{itemSize:e}=A();D===-e*E?(D=0,S=1,P(D,b.resetDuration),setTimeout(()=>{D-=e*h,S++,P(D,b.transitionDuration),C&&s(C,S,E),b.onSlideChange&&b.onSlideChange(S)},b.resetDuration+50)):(D-=e*h,S++,S>E&&(S=1),P(D,b.transitionDuration),C&&s(C,S,E),b.onSlideChange&&b.onSlideChange(S))}function T(){z&&(z=!1,f.setAttribute(t,"false"),O&&(O.getIsPaused()?O.resume():O.getIsRunning()||O.start()),b.onPlay&&b.onPlay())}function V(){z||(z=!0,f.setAttribute(t,"true"),O&&O.pause(),b.onPause&&b.onPause())}return function(){const e=function(e){const n=document.createDocumentFragment();return e.forEach(e=>{const t=e.cloneNode(!0);n.appendChild(t)}),n}(y.slice(0,h));w.appendChild(e),A(),b.announceSlides&&(C=function(e,n="polite"){const t=document.createElement("div");return t.setAttribute("aria-live",n),t.setAttribute("aria-atomic","true"),t.className="c-carousel-liveregion c-carousel-visuallyhidden",e.appendChild(t),t}(f,b.ariaLive),s(C,S,E)),O=function(e,n={}){const{interval:t=2e3}=n;let o=null,i=0,r=!1,s=!1;function u(n){r||(0===i&&(i=n),n-i>=t&&(e.advanceSlide&&e.advanceSlide(),i=n)),o=requestAnimationFrame(u)}return{start:function(){s||(s=!0,r=!1,i=0,o=requestAnimationFrame(u))},stop:function(){o&&(cancelAnimationFrame(o),o=null),s=!1,r=!1,i=0},pause:function(){r=!0},resume:function(){r&&(r=!1,i=0)},getIsRunning:function(){return s},getIsPaused:function(){return r}}}({advanceSlide:N,container:f},{interval:b.interval}),b.observeResize&&(I=l({recalculateDimensions:A,container:f}),I.observe()),b.observeVisibility&&($=function(e,n={}){const{threshold:t=.5}=n;let o=null;function i(n){n.forEach(n=>{n.isIntersecting?e.play():e.pause()})}return{observe:function(){"IntersectionObserver"in window?(o||(o=new IntersectionObserver(i,{threshold:t})),o.observe(e.container)):console.warn("IntersectionObserver not supported. Carousel will run continuously.")},disconnect:function(){o&&(o.disconnect(),o=null)}}}({play:T,pause:V,container:f},{threshold:.5}),$.observe()),b.pauseOnHover&&(f.addEventListener("mouseenter",V),f.addEventListener("mouseleave",T)),b.pauseOnFocus&&(f.addEventListener("focusin",V),f.addEventListener("focusout",T)),b.autoplay&&O.start()}(),{play:T,pause:V,destroy:function(){O&&O.stop(),$&&$.disconnect(),I&&I.disconnect(),b.pauseOnHover&&(f.removeEventListener("mouseenter",V),f.removeEventListener("mouseleave",T)),b.pauseOnFocus&&(f.removeEventListener("focusin",V),f.removeEventListener("focusout",T)),C&&C.remove(),b.onDestroy&&b.onDestroy()},updateConfig:function(e){Object.assign(b,e),void 0!==e.transitionDuration&&A()},container:f,config:b}}export{d as default};